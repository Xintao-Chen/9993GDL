(role xrow)
(role xcolumn)
(role xlevel)
(role orow)
(role ocolumn)
(role olevel)

(init (cell 1 1 1 b))
(init (cell 1 1 2 b))
(init (cell 1 1 3 b))
(init (cell 1 2 1 b))
(init (cell 1 2 2 b))
(init (cell 1 2 3 b))
(init (cell 1 3 1 b))
(init (cell 1 3 2 b))
(init (cell 1 3 3 b))
(init (cell 2 1 1 b))
(init (cell 2 1 2 b))
(init (cell 2 1 3 b))
(init (cell 2 2 1 b))
(init (cell 2 2 2 b))
(init (cell 2 2 3 b))
(init (cell 2 3 1 b))
(init (cell 2 3 2 b))
(init (cell 2 3 3 b))
(init (cell 3 1 1 b))
(init (cell 3 1 2 b))
(init (cell 3 1 3 b))
(init (cell 3 2 1 b))
(init (cell 3 2 2 b))
(init (cell 3 2 3 b))
(init (cell 3 3 1 b))
(init (cell 3 3 2 b))
(init (cell 3 3 3 b))
(init (control xrow))

(<= (legal xrow (select ?x))
    (true (control xrow))
    (true (cell ?x ?y ?z b))
    (distinct ?x 0)
    (distinct ?x 4))

(<= (legal xcolumn (select ?y))
    (true (control xcolumn))
    (true (cell ?x ?y ?z b))
    (distinct ?y 0)
    (distinct ?y 4))

(<= (legal xlevel (select ?z))
    (true (control xlevel))
    (true (cell ?x ?y ?z b))
    (distinct ?z 0)
    (distinct ?z 4))

(<= (legal orow (select ?x))
    (true (control orow))
    (true (cell ?x ?y ?z b))
    (distinct ?x 0)
    (distinct ?x 4))

(<= (legal ocolumn (select ?y))
    (true (control ocolumn))
    (true (cell ?x ?y ?z b))
    (distinct ?y 0)
    (distinct ?y 4))

(<= (legal olevel (select ?z))
    (true (control olevel))
    (true (cell ?x ?y ?z b))
    (distinct ?z 0)
    (distinct ?z 4))

(<= (legal ?player noop)
    (true (control ?player))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (next (cell ?x ?y ?z x))
    (does xrow (select ?x))
    (does xcolumn (select ?y))
    (does xlevel (select ?z))
    (true (cell ?x ?y ?z b)))

(<= (next (cell ?x ?y ?z o))
    (does orow (select ?x))
    (does ocolumn (select ?y))
    (does olevel (select ?z))
    (true (cell ?x ?y ?z b)))

(<= (next (cell ?x ?y ?z ?mark))
    (true (cell ?x ?y ?z ?mark))
    (distinct ?mark b))

(<= (next (control xcolumn))
    (true (control xrow)))

(<= (next (control xlevel))
    (true (control xcolumn)))

(<= (next (control orow))
    (true (control xlevel)))

(<= (next (control ocolumn))
    (true (control orow)))

(<= (next (control olevel))
    (true (control ocolumn)))

(<= (next (control xrow))
    (true (control olevel)))

(<= (line ?mark)
    (true (cell ?x ?y 1 ?mark))
    (true (cell ?x ?y 2 ?mark))
    (true (cell ?x ?y 3 ?mark)))

(<= (line ?mark)
    (true (cell ?x 1 ?z ?mark))
    (true (cell ?x 2 ?z ?mark))
    (true (cell ?x 3 ?z ?mark)))

(<= (line ?mark)
    (true (cell 1 ?y ?z ?mark))
    (true (cell 2 ?y ?z ?mark))
    (true (cell 3 ?y ?z ?mark)))

(<= (line ?mark)
    (true (cell 1 1 1 ?mark))
    (true (cell 2 2 2 ?mark))
    (true (cell 3 3 3 ?mark)))

(<= (line ?mark)
    (true (cell 3 1 1 ?mark))
    (true (cell 2 2 2 ?mark))
    (true (cell 1 3 3 ?mark)))

(<= (line ?mark)
    (true (cell 1 1 3 ?mark))
    (true (cell 2 2 2 ?mark))
    (true (cell 3 3 1 ?mark)))

(<= (line ?mark)
    (true (cell 3 1 3 ?mark))
    (true (cell 2 2 2 ?mark))
    (true (cell 1 3 1 ?mark)))

(<= (line ?mark)
    (true (cell 1 1 ?z ?mark))
    (true (cell 2 2 ?z ?mark))
    (true (cell 3 3 ?z ?mark)))

(<= (line ?mark)
    (true (cell 3 1 ?z ?mark))
    (true (cell 2 2 ?z ?mark))
    (true (cell 1 3 ?z ?mark)))

(<= (line ?mark)
    (true (cell ?x 1 1 ?mark))
    (true (cell ?x 2 2 ?mark))
    (true (cell ?x 3 3 ?mark)))

(<= (line ?mark)
    (true (cell ?x 3 1 ?mark))
    (true (cell ?x 2 2 ?mark))
    (true (cell ?x 1 3 ?mark)))

(<= (line ?mark)
    (true (cell 1 ?y 1 ?mark))
    (true (cell 2 ?y 2 ?mark))
    (true (cell 3 ?y 3 ?mark)))

(<= (line ?mark)
    (true (cell 3 ?y 1 ?mark))
    (true (cell 2 ?y 2 ?mark))
    (true (cell 1 ?y 3 ?mark)))

(<= (terminal)
    (line x))

(<= (terminal)
    (line o))

(<= (terminal)
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal xrow 100)
    (line x))

(<= (goal xcolumn 100)
    (line x))

(<= (goal xlevel 100)
    (line x))

(<= (goal orow 100)
    (line o))

(<= (goal ocolumn 100)
    (line o))

(<= (goal olevel 100)
    (line o))

(<= (goal xrow 50)
    (not (line x))
    (not (line o))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal xcolumn 50)
    (not (line x))
    (not (line o))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal xlevel 50)
    (not (line x))
    (not (line o))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal orow 50)
    (not (line x))
    (not (line o))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal ocolumn 50)
    (not (line x))
    (not (line o))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal olevel 50)
    (not (line x))
    (not (line o))
    (not (exists (?x ?y ?z) (true (cell ?x ?y ?z b)))))

(<= (goal xrow 50)
    (line o))

(<= (goal xcolumn 50)
    (line o))

(<= (goal xlevel 50)
    (line o))

(<= (goal orow 50)
    (line x))

(<= (goal ocolumn 50)
    (line x))

(<= (goal olevel 50)
    (line x))

(<= (goal xrow 0)
    (line o))

(<= (goal xcolumn 0)
    (line o))

(<= (goal xlevel 0)
    (line o))

(<= (goal orow 0)
    (line x))

(<= (goal ocolumn 0)
    (line x))

(<= (goal olevel 0)
    (line x))