(role xplayer)
(role oplayer)

(init (control xplayer))
(init (cell 1 1 1 b))
(init (cell 1 1 2 b))
(init (cell 1 1 3 b))
(init (cell 1 2 1 b))
(init (cell 1 2 2 b))
(init (cell 1 2 3 b))
(init (cell 1 3 1 b))
(init (cell 1 3 2 b))
(init (cell 1 3 3 b))
(init (cell 2 1 1 b))
(init (cell 2 1 2 b))
(init (cell 2 1 3 b))
(init (cell 2 2 1 b))
(init (cell 2 2 2 b))
(init (cell 2 2 3 b))
(init (cell 2 3 1 b))
(init (cell 2 3 2 b))
(init (cell 2 3 3 b))
(init (cell 3 1 1 b))
(init (cell 3 1 2 b))
(init (cell 3 1 3 b))
(init (cell 3 2 1 b))
(init (cell 3 2 2 b))
(init (cell 3 2 3 b))
(init (cell 3 3 1 b))
(init (cell 3 3 2 b))
(init (cell 3 3 3 b))

(<= (legal ?player (mark ?x ?y ?z))
    (role ?player)
    (true (control ?player))
    (index ?x)
    (index ?y)
    (index ?z)
    (true (cell ?x ?y ?z b)))

(<= (legal xplayer noop)
    (true (control oplayer)))
(<= (legal oplayer noop)
    (true (control xplayer)))

(<= (next (cell ?x ?y ?z x))
    (does xplayer (mark ?x ?y ?z))
    (true (cell ?x ?y ?z b)))
(<= (next (cell ?x ?y ?z o))
    (does oplayer (mark ?x ?y ?z))
    (true (cell ?x ?y ?z b)))
(<= (next (cell ?x ?y ?z ?w))
    (true (cell ?x ?y ?z ?w))
    (distinct ?w b))

(<= (next (control oplayer))
    (true (control xplayer)))
(<= (next (control xplayer))
    (true (control oplayer)))

(<= (line ?player)
    (role ?player)
    (index ?x1)
    (index ?x2)
    (index ?x3)
    (index ?y1)
    (index ?y2)
    (index ?y3)
    (index ?z1)
    (index ?z2)
    (index ?z3)
    (true (cell ?x1 ?y1 ?z1 ?player))
    (true (cell ?x2 ?y2 ?z2 ?player))
    (true (cell ?x3 ?y3 ?z3 ?player))
    (or (and (distinct ?x1 ?x2) (distinct ?x2 ?x3))
        (and (distinct ?y1 ?y2) (distinct ?y2 ?y3))
        (and (distinct ?z1 ?z2) (distinct ?z2 ?z3))))

(<= (terminal)
    (line xplayer))
(<= (terminal)
    (line oplayer))
(<= (terminal)
    (not (true (cell ?x ?y ?z b)))
    (index ?x)
    (index ?y)
    (index ?z))

(<= (goal xplayer 100)
    (line xplayer))
(<= (goal oplayer 0)
    (line xplayer))
(<= (goal oplayer 100)
    (line oplayer))
(<= (goal xplayer 0)
    (line oplayer))
(<= (goal xplayer 50)
    (not (line xplayer))
    (not (line oplayer))
    (terminal))
(<= (goal oplayer 50)
    (not (line xplayer))
    (not (line oplayer))
    (terminal))

(index 1)
(index 2)
(index 3)