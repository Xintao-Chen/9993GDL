/srv/scratch/z5485311/GDL2NL/myeny/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:07<00:22,  7.48s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.23s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:05,  5.79s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  3.99s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.83s/it]
/srv/scratch/z5485311/GDL2NL/LLM/llama_finetune/finetune.py:87: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.0424
  0%|          | 0/220 [00:00<?, ?it/s]  0%|          | 1/220 [00:01<06:23,  1.75s/it]  1%|          | 2/220 [00:03<05:38,  1.55s/it]  1%|▏         | 3/220 [00:04<05:22,  1.49s/it]  2%|▏         | 4/220 [00:05<05:14,  1.46s/it]  2%|▏         | 5/220 [00:07<05:09,  1.44s/it]  3%|▎         | 6/220 [00:08<05:06,  1.43s/it]  3%|▎         | 7/220 [00:10<05:03,  1.42s/it]  4%|▎         | 8/220 [00:11<05:00,  1.42s/it]  4%|▍         | 9/220 [00:13<04:58,  1.42s/it]  5%|▍         | 10/220 [00:14<04:57,  1.41s/it]                                                  5%|▍         | 10/220 [00:14<04:57,  1.41s/it]  5%|▌         | 11/220 [00:15<04:55,  1.41s/it]  5%|▌         | 12/220 [00:17<04:54,  1.41s/it]  6%|▌         | 13/220 [00:18<04:52,  1.41s/it]  6%|▋         | 14/220 [00:20<04:51,  1.42s/it]  7%|▋         | 15/220 [00:21<04:50,  1.42s/it]  7%|▋         | 16/220 [00:22<04:48,  1.41s/it]  8%|▊         | 17/220 [00:24<04:46,  1.41s/it]  8%|▊         | 18/220 [00:25<04:45,  1.42s/it]  9%|▊         | 19/220 [00:27<04:44,  1.42s/it]  9%|▉         | 20/220 [00:28<04:43,  1.42s/it]                                                  9%|▉         | 20/220 [00:28<04:43,  1.42s/it] 10%|▉         | 21/220 [00:30<04:41,  1.42s/it] 10%|█         | 22/220 [00:31<04:40,  1.42s/it] 10%|█         | 23/220 [00:32<04:38,  1.42s/it] 11%|█         | 24/220 [00:34<04:37,  1.42s/it] 11%|█▏        | 25/220 [00:35<04:36,  1.42s/it] 12%|█▏        | 26/220 [00:37<04:34,  1.42s/it] 12%|█▏        | 27/220 [00:38<04:33,  1.42s/it] 13%|█▎        | 28/220 [00:39<04:31,  1.42s/it] 13%|█▎        | 29/220 [00:41<04:30,  1.41s/it] 14%|█▎        | 30/220 [00:42<04:29,  1.42s/it]                                                 14%|█▎        | 30/220 [00:42<04:29,  1.42s/it] 14%|█▍        | 31/220 [00:44<04:27,  1.42s/it] 15%|█▍        | 32/220 [00:45<04:26,  1.42s/it] 15%|█▌        | 33/220 [00:47<04:24,  1.42s/it] 15%|█▌        | 34/220 [00:48<04:23,  1.42s/it] 16%|█▌        | 35/220 [00:49<04:22,  1.42s/it] 16%|█▋        | 36/220 [00:51<04:20,  1.42s/it] 17%|█▋        | 37/220 [00:52<04:19,  1.42s/it] 17%|█▋        | 38/220 [00:54<04:18,  1.42s/it] 18%|█▊        | 39/220 [00:55<04:16,  1.42s/it] 18%|█▊        | 40/220 [00:56<04:15,  1.42s/it]                                                 18%|█▊        | 40/220 [00:56<04:15,  1.42s/it] 19%|█▊        | 41/220 [00:58<04:13,  1.42s/it] 19%|█▉        | 42/220 [00:59<04:12,  1.42s/it] 20%|█▉        | 43/220 [01:01<04:11,  1.42s/it] 20%|██        | 44/220 [01:02<04:10,  1.42s/it] 20%|██        | 45/220 [01:05<05:24,  1.86s/it] 21%|██        | 46/220 [01:06<04:59,  1.72s/it] 21%|██▏       | 47/220 [01:08<04:42,  1.63s/it] 22%|██▏       | 48/220 [01:09<04:29,  1.57s/it] 22%|██▏       | 49/220 [01:11<04:20,  1.52s/it] 23%|██▎       | 50/220 [01:12<04:13,  1.49s/it]                                                 23%|██▎       | 50/220 [01:12<04:13,  1.49s/it] 23%|██▎       | 51/220 [01:14<04:08,  1.47s/it] 24%|██▎       | 52/220 [01:15<04:04,  1.45s/it] 24%|██▍       | 53/220 [01:16<04:01,  1.44s/it] 25%|██▍       | 54/220 [01:18<03:58,  1.44s/it] 25%|██▌       | 55/220 [01:19<03:56,  1.43s/it] 25%|██▌       | 56/220 [01:21<03:54,  1.43s/it] 26%|██▌       | 57/220 [01:22<03:52,  1.43s/it] 26%|██▋       | 58/220 [01:23<03:50,  1.42s/it] 27%|██▋       | 59/220 [01:25<03:49,  1.42s/it] 27%|██▋       | 60/220 [01:26<03:47,  1.42s/it]                                                 27%|██▋       | 60/220 [01:26<03:47,  1.42s/it] 28%|██▊       | 61/220 [01:28<03:46,  1.42s/it] 28%|██▊       | 62/220 [01:29<03:44,  1.42s/it] 29%|██▊       | 63/220 [01:31<03:43,  1.42s/it] 29%|██▉       | 64/220 [01:32<03:41,  1.42s/it] 30%|██▉       | 65/220 [01:33<03:40,  1.42s/it] 30%|███       | 66/220 [01:35<03:39,  1.42s/it] 30%|███       | 67/220 [01:36<03:37,  1.42s/it] 31%|███       | 68/220 [01:38<03:36,  1.42s/it] 31%|███▏      | 69/220 [01:39<03:34,  1.42s/it] 32%|███▏      | 70/220 [01:41<03:33,  1.42s/it]                                                 32%|███▏      | 70/220 [01:41<03:33,  1.42s/it] 32%|███▏      | 71/220 [01:42<03:31,  1.42s/it] 33%|███▎      | 72/220 [01:43<03:30,  1.42s/it] 33%|███▎      | 73/220 [01:45<03:28,  1.42s/it] 34%|███▎      | 74/220 [01:46<03:27,  1.42s/it] 34%|███▍      | 75/220 [01:48<03:26,  1.42s/it] 35%|███▍      | 76/220 [01:49<03:24,  1.42s/it] 35%|███▌      | 77/220 [01:50<03:23,  1.42s/it] 35%|███▌      | 78/220 [01:52<03:21,  1.42s/it] 36%|███▌      | 79/220 [01:53<03:20,  1.42s/it] 36%|███▋      | 80/220 [01:55<03:18,  1.42s/it]                                                 36%|███▋      | 80/220 [01:55<03:18,  1.42s/it] 37%|███▋      | 81/220 [01:56<03:17,  1.42s/it] 37%|███▋      | 82/220 [01:58<03:15,  1.42s/it] 38%|███▊      | 83/220 [01:59<03:14,  1.42s/it] 38%|███▊      | 84/220 [02:00<03:13,  1.42s/it] 39%|███▊      | 85/220 [02:02<03:11,  1.42s/it] 39%|███▉      | 86/220 [02:03<03:10,  1.42s/it] 40%|███▉      | 87/220 [02:05<03:09,  1.42s/it] 40%|████      | 88/220 [02:06<03:07,  1.42s/it] 40%|████      | 89/220 [02:09<04:19,  1.98s/it] 41%|████      | 90/220 [02:11<03:55,  1.81s/it]                                                 41%|████      | 90/220 [02:11<03:55,  1.81s/it] 41%|████▏     | 91/220 [02:12<03:38,  1.69s/it] 42%|████▏     | 92/220 [02:14<03:26,  1.61s/it] 42%|████▏     | 93/220 [02:15<03:17,  1.56s/it] 43%|████▎     | 94/220 [02:16<03:10,  1.51s/it] 43%|████▎     | 95/220 [02:18<03:05,  1.49s/it] 44%|████▎     | 96/220 [02:19<03:01,  1.47s/it] 44%|████▍     | 97/220 [02:21<02:58,  1.45s/it] 45%|████▍     | 98/220 [02:22<02:56,  1.44s/it] 45%|████▌     | 99/220 [02:24<02:53,  1.44s/it] 45%|████▌     | 100/220 [02:25<02:51,  1.43s/it]                                                  45%|████▌     | 100/220 [02:25<02:51,  1.43s/it] 46%|████▌     | 101/220 [02:26<02:50,  1.43s/it] 46%|████▋     | 102/220 [02:28<02:48,  1.43s/it] 47%|████▋     | 103/220 [02:29<02:46,  1.42s/it] 47%|████▋     | 104/220 [02:31<02:44,  1.42s/it] 48%|████▊     | 105/220 [02:32<02:43,  1.42s/it] 48%|████▊     | 106/220 [02:34<02:41,  1.42s/it] 49%|████▊     | 107/220 [02:35<02:40,  1.42s/it] 49%|████▉     | 108/220 [02:36<02:38,  1.42s/it] 50%|████▉     | 109/220 [02:38<02:37,  1.42s/it] 50%|█████     | 110/220 [02:39<02:36,  1.42s/it]                                                  50%|█████     | 110/220 [02:39<02:36,  1.42s/it] 50%|█████     | 111/220 [02:41<02:34,  1.42s/it] 51%|█████     | 112/220 [02:42<02:33,  1.42s/it] 51%|█████▏    | 113/220 [02:43<02:31,  1.42s/it] 52%|█████▏    | 114/220 [02:45<02:30,  1.42s/it] 52%|█████▏    | 115/220 [02:46<02:29,  1.42s/it] 53%|█████▎    | 116/220 [02:48<02:27,  1.42s/it] 53%|█████▎    | 117/220 [02:49<02:26,  1.42s/it] 54%|█████▎    | 118/220 [02:51<02:24,  1.42s/it] 54%|█████▍    | 119/220 [02:52<02:23,  1.42s/it] 55%|█████▍    | 120/220 [02:53<02:21,  1.42s/it]                                                  55%|█████▍    | 120/220 [02:53<02:21,  1.42s/it] 55%|█████▌    | 121/220 [02:55<02:20,  1.42s/it] 55%|█████▌    | 122/220 [02:56<02:19,  1.42s/it] 56%|█████▌    | 123/220 [02:58<02:17,  1.42s/it] 56%|█████▋    | 124/220 [02:59<02:16,  1.42s/it] 57%|█████▋    | 125/220 [03:00<02:14,  1.42s/it] 57%|█████▋    | 126/220 [03:02<02:13,  1.42s/it] 58%|█████▊    | 127/220 [03:03<02:12,  1.42s/it] 58%|█████▊    | 128/220 [03:05<02:10,  1.42s/it] 59%|█████▊    | 129/220 [03:06<02:09,  1.42s/it] 59%|█████▉    | 130/220 [03:08<02:07,  1.42s/it]                                                  59%|█████▉    | 130/220 [03:08<02:07,  1.42s/it] 60%|█████▉    | 131/220 [03:09<02:06,  1.42s/it] 60%|██████    | 132/220 [03:10<02:04,  1.42s/it] 60%|██████    | 133/220 [03:14<02:46,  1.92s/it] 61%|██████    | 134/220 [03:15<02:32,  1.77s/it] 61%|██████▏   | 135/220 [03:16<02:21,  1.66s/it] 62%|██████▏   | 136/220 [03:18<02:13,  1.59s/it] 62%|██████▏   | 137/220 [03:19<02:07,  1.54s/it] 63%|██████▎   | 138/220 [03:21<02:03,  1.50s/it] 63%|██████▎   | 139/220 [03:22<01:59,  1.48s/it] 64%|██████▎   | 140/220 [03:23<01:56,  1.46s/it]                                                  64%|██████▎   | 140/220 [03:23<01:56,  1.46s/it] 64%|██████▍   | 141/220 [03:25<01:54,  1.45s/it] 65%|██████▍   | 142/220 [03:26<01:52,  1.44s/it] 65%|██████▌   | 143/220 [03:28<01:50,  1.43s/it] 65%|██████▌   | 144/220 [03:29<01:48,  1.43s/it] 66%|██████▌   | 145/220 [03:31<01:47,  1.43s/it] 66%|██████▋   | 146/220 [03:32<01:45,  1.43s/it] 67%|██████▋   | 147/220 [03:33<01:43,  1.42s/it] 67%|██████▋   | 148/220 [03:35<01:42,  1.42s/it] 68%|██████▊   | 149/220 [03:36<01:40,  1.42s/it] 68%|██████▊   | 150/220 [03:38<01:39,  1.42s/it]                                                  68%|██████▊   | 150/220 [03:38<01:39,  1.42s/it] 69%|██████▊   | 151/220 [03:39<01:38,  1.42s/it] 69%|██████▉   | 152/220 [03:40<01:36,  1.42s/it] 70%|██████▉   | 153/220 [03:42<01:35,  1.42s/it] 70%|███████   | 154/220 [03:43<01:33,  1.42s/it] 70%|███████   | 155/220 [03:45<01:32,  1.42s/it] 71%|███████   | 156/220 [03:46<01:30,  1.42s/it] 71%|███████▏  | 157/220 [03:48<01:29,  1.42s/it] 72%|███████▏  | 158/220 [03:49<01:28,  1.42s/it] 72%|███████▏  | 159/220 [03:50<01:26,  1.42s/it] 73%|███████▎  | 160/220 [03:52<01:25,  1.42s/it]                                                  73%|███████▎  | 160/220 [03:52<01:25,  1.42s/it] 73%|███████▎  | 161/220 [03:53<01:23,  1.42s/it] 74%|███████▎  | 162/220 [03:55<01:22,  1.42s/it] 74%|███████▍  | 163/220 [03:56<01:20,  1.42s/it] 75%|███████▍  | 164/220 [03:58<01:19,  1.42s/it] 75%|███████▌  | 165/220 [03:59<01:18,  1.42s/it] 75%|███████▌  | 166/220 [04:00<01:16,  1.42s/it] 76%|███████▌  | 167/220 [04:02<01:15,  1.42s/it] 76%|███████▋  | 168/220 [04:03<01:13,  1.42s/it] 77%|███████▋  | 169/220 [04:05<01:12,  1.42s/it] 77%|███████▋  | 170/220 [04:06<01:11,  1.42s/it]                                                  77%|███████▋  | 170/220 [04:06<01:11,  1.42s/it] 78%|███████▊  | 171/220 [04:07<01:09,  1.42s/it] 78%|███████▊  | 172/220 [04:09<01:08,  1.42s/it] 79%|███████▊  | 173/220 [04:10<01:06,  1.42s/it] 79%|███████▉  | 174/220 [04:12<01:05,  1.42s/it] 80%|███████▉  | 175/220 [04:13<01:03,  1.42s/it] 80%|████████  | 176/220 [04:15<01:02,  1.42s/it] 80%|████████  | 177/220 [04:18<01:32,  2.15s/it] 81%|████████  | 178/220 [04:20<01:21,  1.93s/it] 81%|████████▏ | 179/220 [04:21<01:12,  1.78s/it] 82%|████████▏ | 180/220 [04:23<01:06,  1.67s/it]                                                  82%|████████▏ | 180/220 [04:23<01:06,  1.67s/it] 82%|████████▏ | 181/220 [04:24<01:02,  1.59s/it] 83%|████████▎ | 182/220 [04:26<00:58,  1.54s/it] 83%|████████▎ | 183/220 [04:27<00:55,  1.50s/it] 84%|████████▎ | 184/220 [04:28<00:53,  1.48s/it] 84%|████████▍ | 185/220 [04:30<00:51,  1.46s/it] 85%|████████▍ | 186/220 [04:31<00:49,  1.45s/it] 85%|████████▌ | 187/220 [04:33<00:47,  1.44s/it] 85%|████████▌ | 188/220 [04:34<00:45,  1.43s/it] 86%|████████▌ | 189/220 [04:35<00:44,  1.43s/it] 86%|████████▋ | 190/220 [04:37<00:42,  1.42s/it]                                                  86%|████████▋ | 190/220 [04:37<00:42,  1.42s/it] 87%|████████▋ | 191/220 [04:38<00:41,  1.42s/it] 87%|████████▋ | 192/220 [04:40<00:39,  1.42s/it] 88%|████████▊ | 193/220 [04:41<00:38,  1.42s/it] 88%|████████▊ | 194/220 [04:43<00:36,  1.42s/it] 89%|████████▊ | 195/220 [04:44<00:35,  1.42s/it] 89%|████████▉ | 196/220 [04:45<00:34,  1.42s/it] 90%|████████▉ | 197/220 [04:47<00:32,  1.42s/it] 90%|█████████ | 198/220 [04:48<00:31,  1.42s/it] 90%|█████████ | 199/220 [04:50<00:29,  1.42s/it] 91%|█████████ | 200/220 [04:51<00:28,  1.42s/it]                                                  91%|█████████ | 200/220 [04:51<00:28,  1.42s/it] 91%|█████████▏| 201/220 [04:53<00:27,  1.42s/it] 92%|█████████▏| 202/220 [04:54<00:25,  1.42s/it] 92%|█████████▏| 203/220 [04:55<00:24,  1.42s/it] 93%|█████████▎| 204/220 [04:57<00:22,  1.42s/it] 93%|█████████▎| 205/220 [04:58<00:21,  1.42s/it] 94%|█████████▎| 206/220 [05:00<00:19,  1.42s/it] 94%|█████████▍| 207/220 [05:01<00:18,  1.42s/it] 95%|█████████▍| 208/220 [05:02<00:17,  1.42s/it] 95%|█████████▌| 209/220 [05:04<00:15,  1.42s/it] 95%|█████████▌| 210/220 [05:05<00:14,  1.42s/it]                                                  95%|█████████▌| 210/220 [05:05<00:14,  1.42s/it] 96%|█████████▌| 211/220 [05:07<00:12,  1.42s/it] 96%|█████████▋| 212/220 [05:08<00:11,  1.42s/it] 97%|█████████▋| 213/220 [05:10<00:09,  1.42s/it] 97%|█████████▋| 214/220 [05:11<00:08,  1.42s/it] 98%|█████████▊| 215/220 [05:12<00:07,  1.42s/it] 98%|█████████▊| 216/220 [05:14<00:05,  1.42s/it] 99%|█████████▊| 217/220 [05:15<00:04,  1.42s/it] 99%|█████████▉| 218/220 [05:17<00:02,  1.42s/it]100%|█████████▉| 219/220 [05:18<00:01,  1.42s/it]100%|██████████| 220/220 [05:19<00:00,  1.42s/it]                                                 100%|██████████| 220/220 [05:19<00:00,  1.42s/it]                                                 100%|██████████| 220/220 [05:21<00:00,  1.42s/it]100%|██████████| 220/220 [05:21<00:00,  1.46s/it]
{'loss': 0.3332, 'grad_norm': 0.20703125, 'learning_rate': 4.795454545454546e-06, 'epoch': 0.23}
{'loss': 0.3708, 'grad_norm': 0.1630859375, 'learning_rate': 4.568181818181819e-06, 'epoch': 0.45}
{'loss': 0.3445, 'grad_norm': 0.1884765625, 'learning_rate': 4.340909090909091e-06, 'epoch': 0.68}
{'loss': 0.344, 'grad_norm': 0.185546875, 'learning_rate': 4.113636363636364e-06, 'epoch': 0.91}
{'loss': 0.3672, 'grad_norm': 0.18359375, 'learning_rate': 3.886363636363637e-06, 'epoch': 1.14}
{'loss': 0.3276, 'grad_norm': 0.6015625, 'learning_rate': 3.6590909090909093e-06, 'epoch': 1.36}
{'loss': 0.3341, 'grad_norm': 0.19140625, 'learning_rate': 3.4318181818181823e-06, 'epoch': 1.59}
{'loss': 0.3347, 'grad_norm': 0.208984375, 'learning_rate': 3.204545454545455e-06, 'epoch': 1.82}
{'loss': 0.3432, 'grad_norm': 0.1826171875, 'learning_rate': 2.9772727272727274e-06, 'epoch': 2.05}
{'loss': 0.3434, 'grad_norm': 0.2041015625, 'learning_rate': 2.7500000000000004e-06, 'epoch': 2.27}
{'loss': 0.3482, 'grad_norm': 0.2080078125, 'learning_rate': 2.522727272727273e-06, 'epoch': 2.5}
{'loss': 0.3472, 'grad_norm': 0.1943359375, 'learning_rate': 2.295454545454546e-06, 'epoch': 2.73}
{'loss': 0.31, 'grad_norm': 0.25, 'learning_rate': 2.0681818181818184e-06, 'epoch': 2.95}
{'loss': 0.3646, 'grad_norm': 0.228515625, 'learning_rate': 1.840909090909091e-06, 'epoch': 3.18}
{'loss': 0.3442, 'grad_norm': 0.2041015625, 'learning_rate': 1.613636363636364e-06, 'epoch': 3.41}
{'loss': 0.316, 'grad_norm': 0.1962890625, 'learning_rate': 1.3863636363636365e-06, 'epoch': 3.64}
{'loss': 0.3201, 'grad_norm': 0.177734375, 'learning_rate': 1.159090909090909e-06, 'epoch': 3.86}
{'loss': 0.3588, 'grad_norm': 0.234375, 'learning_rate': 9.31818181818182e-07, 'epoch': 4.09}
{'loss': 0.3257, 'grad_norm': 0.220703125, 'learning_rate': 7.045454545454545e-07, 'epoch': 4.32}
{'loss': 0.3483, 'grad_norm': 0.1767578125, 'learning_rate': 4.772727272727274e-07, 'epoch': 4.55}
{'loss': 0.3481, 'grad_norm': 0.24609375, 'learning_rate': 2.5000000000000004e-07, 'epoch': 4.77}
{'loss': 0.3154, 'grad_norm': 0.2265625, 'learning_rate': 2.272727272727273e-08, 'epoch': 5.0}
{'train_runtime': 321.4946, 'train_samples_per_second': 2.737, 'train_steps_per_second': 0.684, 'train_loss': 0.3404329375787215, 'epoch': 5.0}

================================================================================
                     Resource Usage on 13/08/2025 18:08:22                      

Job Id: 6789534 
Queue: CSE
Walltime: 00:07:01  (requested 02:00:00)
Job execution was successful. Exit Status 0. 

--------------------------------------------------------------------------------
|              |             GPUs              |            Memory             |
--------------------------------------------------------------------------------
| Node  GPU ID | Requested   Used   Efficiency | Available   Used              |
| k099    2    |     1       0.72       72%    |143771 MiB  44.91G             |
--------------------------------------------------------------------------------
|Total         |     1       0.72      72.0%   |                               |
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
|              |             CPUs              |            Memory             |
--------------------------------------------------------------------------------
| Node         | Requested   Used   Efficiency | Requested   Used   Efficiency |
| k099         |     4       0.79      20.0%   |  48.0gb    16.17gb    33.7%   |
--------------------------------------------------------------------------------
