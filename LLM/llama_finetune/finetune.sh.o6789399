/srv/scratch/z5485311/GDL2NL/myeny/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:09<00:28,  9.46s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:15<00:15,  7.55s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:22<00:07,  7.45s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:24<00:00,  5.07s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:24<00:00,  6.10s/it]
/srv/scratch/z5485311/GDL2NL/LLM/llama_finetune/finetune.py:84: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
trainable params: 3,407,872 || all params: 8,033,669,120 || trainable%: 0.0424
  0%|          | 0/220 [00:00<?, ?it/s]  0%|          | 1/220 [00:05<20:54,  5.73s/it]  1%|          | 2/220 [00:07<11:34,  3.19s/it]  1%|▏         | 3/220 [00:08<08:35,  2.37s/it]  2%|▏         | 4/220 [00:09<07:10,  1.99s/it]  2%|▏         | 5/220 [00:11<06:23,  1.78s/it]  3%|▎         | 6/220 [00:12<05:54,  1.65s/it]  3%|▎         | 7/220 [00:14<05:35,  1.57s/it]  4%|▎         | 8/220 [00:15<05:22,  1.52s/it]  4%|▍         | 9/220 [00:16<05:13,  1.49s/it]  5%|▍         | 10/220 [00:18<05:07,  1.46s/it]                                                  5%|▍         | 10/220 [00:18<05:07,  1.46s/it]  5%|▌         | 11/220 [00:19<05:02,  1.45s/it]  5%|▌         | 12/220 [00:21<04:59,  1.44s/it]  6%|▌         | 13/220 [00:22<04:55,  1.43s/it]  6%|▋         | 14/220 [00:24<04:53,  1.43s/it]  7%|▋         | 15/220 [00:25<04:51,  1.42s/it]  7%|▋         | 16/220 [00:26<04:49,  1.42s/it]  8%|▊         | 17/220 [00:28<04:47,  1.42s/it]  8%|▊         | 18/220 [00:29<04:45,  1.41s/it]  9%|▊         | 19/220 [00:31<04:44,  1.42s/it]  9%|▉         | 20/220 [00:32<04:42,  1.41s/it]                                                  9%|▉         | 20/220 [00:32<04:42,  1.41s/it] 10%|▉         | 21/220 [00:33<04:41,  1.41s/it] 10%|█         | 22/220 [00:35<04:39,  1.41s/it] 10%|█         | 23/220 [00:36<04:38,  1.41s/it] 11%|█         | 24/220 [00:38<04:37,  1.41s/it] 11%|█▏        | 25/220 [00:39<04:35,  1.41s/it] 12%|█▏        | 26/220 [00:41<04:34,  1.41s/it] 12%|█▏        | 27/220 [00:42<04:32,  1.41s/it] 13%|█▎        | 28/220 [00:43<04:31,  1.41s/it] 13%|█▎        | 29/220 [00:45<04:29,  1.41s/it] 14%|█▎        | 30/220 [00:46<04:28,  1.41s/it]                                                 14%|█▎        | 30/220 [00:46<04:28,  1.41s/it] 14%|█▍        | 31/220 [00:48<04:27,  1.42s/it] 15%|█▍        | 32/220 [00:49<04:26,  1.42s/it] 15%|█▌        | 33/220 [00:50<04:24,  1.42s/it] 15%|█▌        | 34/220 [00:52<04:23,  1.42s/it] 16%|█▌        | 35/220 [00:53<04:22,  1.42s/it] 16%|█▋        | 36/220 [00:55<04:20,  1.41s/it] 17%|█▋        | 37/220 [00:56<04:19,  1.42s/it] 17%|█▋        | 38/220 [00:58<04:17,  1.42s/it] 18%|█▊        | 39/220 [00:59<04:16,  1.42s/it] 18%|█▊        | 40/220 [01:00<04:15,  1.42s/it]                                                 18%|█▊        | 40/220 [01:00<04:15,  1.42s/it] 19%|█▊        | 41/220 [01:02<04:13,  1.42s/it] 19%|█▉        | 42/220 [01:03<04:12,  1.42s/it] 20%|█▉        | 43/220 [01:05<04:10,  1.42s/it] 20%|██        | 44/220 [01:06<04:09,  1.42s/it] 20%|██        | 45/220 [01:09<05:40,  1.95s/it] 21%|██        | 46/220 [01:11<05:11,  1.79s/it] 21%|██▏       | 47/220 [01:12<04:49,  1.68s/it] 22%|██▏       | 48/220 [01:13<04:34,  1.60s/it] 22%|██▏       | 49/220 [01:15<04:23,  1.54s/it] 23%|██▎       | 50/220 [01:16<04:15,  1.50s/it]                                                 23%|██▎       | 50/220 [01:16<04:15,  1.50s/it] 23%|██▎       | 51/220 [01:18<04:09,  1.48s/it] 24%|██▎       | 52/220 [01:19<04:05,  1.46s/it] 24%|██▍       | 53/220 [01:21<04:01,  1.45s/it] 25%|██▍       | 54/220 [01:22<03:58,  1.44s/it] 25%|██▌       | 55/220 [01:23<03:56,  1.43s/it] 25%|██▌       | 56/220 [01:25<03:54,  1.43s/it] 26%|██▌       | 57/220 [01:26<03:52,  1.42s/it] 26%|██▋       | 58/220 [01:28<03:50,  1.42s/it] 27%|██▋       | 59/220 [01:29<03:48,  1.42s/it] 27%|██▋       | 60/220 [01:30<03:47,  1.42s/it]                                                 27%|██▋       | 60/220 [01:30<03:47,  1.42s/it] 28%|██▊       | 61/220 [01:32<03:45,  1.42s/it] 28%|██▊       | 62/220 [01:33<03:44,  1.42s/it] 29%|██▊       | 63/220 [01:35<03:42,  1.42s/it] 29%|██▉       | 64/220 [01:36<03:41,  1.42s/it] 30%|██▉       | 65/220 [01:38<03:39,  1.42s/it] 30%|███       | 66/220 [01:39<03:38,  1.42s/it] 30%|███       | 67/220 [01:40<03:37,  1.42s/it] 31%|███       | 68/220 [01:42<03:35,  1.42s/it] 31%|███▏      | 69/220 [01:43<03:34,  1.42s/it] 32%|███▏      | 70/220 [01:45<03:32,  1.42s/it]                                                 32%|███▏      | 70/220 [01:45<03:32,  1.42s/it] 32%|███▏      | 71/220 [01:46<03:31,  1.42s/it] 33%|███▎      | 72/220 [01:47<03:30,  1.42s/it] 33%|███▎      | 73/220 [01:49<03:28,  1.42s/it] 34%|███▎      | 74/220 [01:50<03:27,  1.42s/it] 34%|███▍      | 75/220 [01:52<03:25,  1.42s/it] 35%|███▍      | 76/220 [01:53<03:24,  1.42s/it] 35%|███▌      | 77/220 [01:55<03:22,  1.42s/it] 35%|███▌      | 78/220 [01:56<03:21,  1.42s/it] 36%|███▌      | 79/220 [01:57<03:19,  1.42s/it] 36%|███▋      | 80/220 [01:59<03:18,  1.42s/it]                                                 36%|███▋      | 80/220 [01:59<03:18,  1.42s/it] 37%|███▋      | 81/220 [02:00<03:16,  1.42s/it] 37%|███▋      | 82/220 [02:02<03:15,  1.42s/it] 38%|███▊      | 83/220 [02:03<03:14,  1.42s/it] 38%|███▊      | 84/220 [02:04<03:12,  1.42s/it] 39%|███▊      | 85/220 [02:06<03:11,  1.42s/it] 39%|███▉      | 86/220 [02:07<03:09,  1.42s/it] 40%|███▉      | 87/220 [02:09<03:08,  1.42s/it] 40%|████      | 88/220 [02:10<03:06,  1.42s/it] 40%|████      | 89/220 [02:14<04:23,  2.01s/it] 41%|████      | 90/220 [02:15<03:58,  1.84s/it]                                                 41%|████      | 90/220 [02:15<03:58,  1.84s/it] 41%|████▏     | 91/220 [02:16<03:40,  1.71s/it] 42%|████▏     | 92/220 [02:18<03:27,  1.62s/it] 42%|████▏     | 93/220 [02:19<03:18,  1.56s/it] 43%|████▎     | 94/220 [02:21<03:11,  1.52s/it] 43%|████▎     | 95/220 [02:22<03:05,  1.49s/it] 44%|████▎     | 96/220 [02:23<03:02,  1.47s/it] 44%|████▍     | 97/220 [02:25<02:58,  1.45s/it] 45%|████▍     | 98/220 [02:26<02:56,  1.44s/it] 45%|████▌     | 99/220 [02:28<02:53,  1.43s/it] 45%|████▌     | 100/220 [02:29<02:51,  1.43s/it]                                                  45%|████▌     | 100/220 [02:29<02:51,  1.43s/it] 46%|████▌     | 101/220 [02:31<02:49,  1.43s/it] 46%|████▋     | 102/220 [02:32<02:48,  1.43s/it] 47%|████▋     | 103/220 [02:33<02:46,  1.42s/it] 47%|████▋     | 104/220 [02:35<02:44,  1.42s/it] 48%|████▊     | 105/220 [02:36<02:43,  1.42s/it] 48%|████▊     | 106/220 [02:38<02:42,  1.42s/it] 49%|████▊     | 107/220 [02:39<02:40,  1.42s/it] 49%|████▉     | 108/220 [02:41<02:39,  1.42s/it] 50%|████▉     | 109/220 [02:42<02:37,  1.42s/it] 50%|█████     | 110/220 [02:43<02:36,  1.42s/it]                                                  50%|█████     | 110/220 [02:43<02:36,  1.42s/it] 50%|█████     | 111/220 [02:45<02:34,  1.42s/it] 51%|█████     | 112/220 [02:46<02:33,  1.42s/it] 51%|█████▏    | 113/220 [02:48<02:31,  1.42s/it] 52%|█████▏    | 114/220 [02:49<02:30,  1.42s/it] 52%|█████▏    | 115/220 [02:50<02:28,  1.42s/it] 53%|█████▎    | 116/220 [02:52<02:27,  1.42s/it] 53%|█████▎    | 117/220 [02:53<02:26,  1.42s/it] 54%|█████▎    | 118/220 [02:55<02:24,  1.42s/it] 54%|█████▍    | 119/220 [02:56<02:23,  1.42s/it] 55%|█████▍    | 120/220 [02:58<02:21,  1.42s/it]                                                  55%|█████▍    | 120/220 [02:58<02:21,  1.42s/it] 55%|█████▌    | 121/220 [02:59<02:20,  1.42s/it] 55%|█████▌    | 122/220 [03:00<02:18,  1.42s/it] 56%|█████▌    | 123/220 [03:02<02:17,  1.42s/it] 56%|█████▋    | 124/220 [03:03<02:16,  1.42s/it] 57%|█████▋    | 125/220 [03:05<02:14,  1.42s/it] 57%|█████▋    | 126/220 [03:06<02:13,  1.42s/it] 58%|█████▊    | 127/220 [03:07<02:11,  1.42s/it] 58%|█████▊    | 128/220 [03:09<02:10,  1.42s/it] 59%|█████▊    | 129/220 [03:10<02:08,  1.42s/it] 59%|█████▉    | 130/220 [03:12<02:07,  1.42s/it]                                                  59%|█████▉    | 130/220 [03:12<02:07,  1.42s/it] 60%|█████▉    | 131/220 [03:13<02:06,  1.42s/it] 60%|██████    | 132/220 [03:15<02:04,  1.42s/it] 60%|██████    | 133/220 [03:17<02:34,  1.78s/it] 61%|██████    | 134/220 [03:19<02:23,  1.67s/it] 61%|██████▏   | 135/220 [03:20<02:15,  1.59s/it] 62%|██████▏   | 136/220 [03:21<02:09,  1.54s/it] 62%|██████▏   | 137/220 [03:23<02:04,  1.50s/it] 63%|██████▎   | 138/220 [03:24<02:01,  1.48s/it] 63%|██████▎   | 139/220 [03:26<01:58,  1.46s/it] 64%|██████▎   | 140/220 [03:27<01:55,  1.45s/it]                                                  64%|██████▎   | 140/220 [03:27<01:55,  1.45s/it] 64%|██████▍   | 141/220 [03:28<01:53,  1.44s/it] 65%|██████▍   | 142/220 [03:30<01:51,  1.43s/it] 65%|██████▌   | 143/220 [03:31<01:49,  1.43s/it] 65%|██████▌   | 144/220 [03:33<01:48,  1.42s/it] 66%|██████▌   | 145/220 [03:34<01:46,  1.43s/it] 66%|██████▋   | 146/220 [03:36<01:45,  1.42s/it] 67%|██████▋   | 147/220 [03:37<01:43,  1.42s/it] 67%|██████▋   | 148/220 [03:38<01:42,  1.42s/it] 68%|██████▊   | 149/220 [03:40<01:40,  1.42s/it] 68%|██████▊   | 150/220 [03:41<01:39,  1.42s/it]                                                  68%|██████▊   | 150/220 [03:41<01:39,  1.42s/it] 69%|██████▊   | 151/220 [03:43<01:37,  1.42s/it] 69%|██████▉   | 152/220 [03:44<01:36,  1.42s/it] 70%|██████▉   | 153/220 [03:46<01:35,  1.42s/it] 70%|███████   | 154/220 [03:47<01:33,  1.42s/it] 70%|███████   | 155/220 [03:48<01:32,  1.42s/it] 71%|███████   | 156/220 [03:50<01:31,  1.42s/it] 71%|███████▏  | 157/220 [03:51<01:29,  1.42s/it] 72%|███████▏  | 158/220 [03:53<01:28,  1.42s/it] 72%|███████▏  | 159/220 [03:54<01:26,  1.42s/it] 73%|███████▎  | 160/220 [03:55<01:25,  1.42s/it]                                                  73%|███████▎  | 160/220 [03:55<01:25,  1.42s/it] 73%|███████▎  | 161/220 [03:57<01:24,  1.42s/it] 74%|███████▎  | 162/220 [03:58<01:22,  1.42s/it] 74%|███████▍  | 163/220 [04:00<01:21,  1.42s/it] 75%|███████▍  | 164/220 [04:01<01:19,  1.42s/it] 75%|███████▌  | 165/220 [04:03<01:18,  1.42s/it] 75%|███████▌  | 166/220 [04:04<01:17,  1.43s/it] 76%|███████▌  | 167/220 [04:05<01:15,  1.43s/it] 76%|███████▋  | 168/220 [04:07<01:14,  1.43s/it] 77%|███████▋  | 169/220 [04:08<01:12,  1.43s/it] 77%|███████▋  | 170/220 [04:10<01:11,  1.43s/it]                                                  77%|███████▋  | 170/220 [04:10<01:11,  1.43s/it] 78%|███████▊  | 171/220 [04:11<01:09,  1.43s/it] 78%|███████▊  | 172/220 [04:13<01:08,  1.42s/it] 79%|███████▊  | 173/220 [04:14<01:06,  1.42s/it] 79%|███████▉  | 174/220 [04:15<01:05,  1.43s/it] 80%|███████▉  | 175/220 [04:17<01:04,  1.43s/it] 80%|████████  | 176/220 [04:18<01:02,  1.43s/it] 80%|████████  | 177/220 [04:21<01:17,  1.79s/it] 81%|████████  | 178/220 [04:22<01:10,  1.68s/it] 81%|████████▏ | 179/220 [04:24<01:05,  1.60s/it] 82%|████████▏ | 180/220 [04:25<01:01,  1.55s/it]                                                  82%|████████▏ | 180/220 [04:25<01:01,  1.55s/it] 82%|████████▏ | 181/220 [04:27<00:58,  1.51s/it] 83%|████████▎ | 182/220 [04:28<00:56,  1.48s/it] 83%|████████▎ | 183/220 [04:29<00:54,  1.47s/it] 84%|████████▎ | 184/220 [04:31<00:52,  1.45s/it] 84%|████████▍ | 185/220 [04:32<00:50,  1.44s/it] 85%|████████▍ | 186/220 [04:34<00:48,  1.43s/it] 85%|████████▌ | 187/220 [04:35<00:47,  1.43s/it] 85%|████████▌ | 188/220 [04:37<00:45,  1.42s/it] 86%|████████▌ | 189/220 [04:38<00:44,  1.43s/it] 86%|████████▋ | 190/220 [04:39<00:42,  1.42s/it]                                                  86%|████████▋ | 190/220 [04:39<00:42,  1.42s/it] 87%|████████▋ | 191/220 [04:41<00:41,  1.42s/it] 87%|████████▋ | 192/220 [04:42<00:39,  1.42s/it] 88%|████████▊ | 193/220 [04:44<00:38,  1.42s/it] 88%|████████▊ | 194/220 [04:45<00:36,  1.42s/it] 89%|████████▊ | 195/220 [04:47<00:35,  1.42s/it] 89%|████████▉ | 196/220 [04:48<00:34,  1.42s/it] 90%|████████▉ | 197/220 [04:49<00:32,  1.43s/it] 90%|█████████ | 198/220 [04:51<00:31,  1.42s/it] 90%|█████████ | 199/220 [04:52<00:29,  1.43s/it] 91%|█████████ | 200/220 [04:54<00:28,  1.43s/it]                                                  91%|█████████ | 200/220 [04:54<00:28,  1.43s/it] 91%|█████████▏| 201/220 [04:55<00:27,  1.43s/it] 92%|█████████▏| 202/220 [04:56<00:25,  1.43s/it] 92%|█████████▏| 203/220 [04:58<00:24,  1.43s/it] 93%|█████████▎| 204/220 [04:59<00:22,  1.42s/it] 93%|█████████▎| 205/220 [05:01<00:21,  1.42s/it] 94%|█████████▎| 206/220 [05:02<00:19,  1.42s/it] 94%|█████████▍| 207/220 [05:04<00:18,  1.42s/it] 95%|█████████▍| 208/220 [05:05<00:17,  1.42s/it] 95%|█████████▌| 209/220 [05:06<00:15,  1.42s/it] 95%|█████████▌| 210/220 [05:08<00:14,  1.42s/it]                                                  95%|█████████▌| 210/220 [05:08<00:14,  1.42s/it] 96%|█████████▌| 211/220 [05:09<00:12,  1.42s/it] 96%|█████████▋| 212/220 [05:11<00:11,  1.42s/it] 97%|█████████▋| 213/220 [05:12<00:09,  1.42s/it] 97%|█████████▋| 214/220 [05:14<00:08,  1.42s/it] 98%|█████████▊| 215/220 [05:15<00:07,  1.42s/it] 98%|█████████▊| 216/220 [05:16<00:05,  1.42s/it] 99%|█████████▊| 217/220 [05:18<00:04,  1.42s/it] 99%|█████████▉| 218/220 [05:19<00:02,  1.42s/it]100%|█████████▉| 219/220 [05:21<00:01,  1.42s/it]100%|██████████| 220/220 [05:22<00:00,  1.42s/it]                                                 100%|██████████| 220/220 [05:22<00:00,  1.42s/it]                                                 100%|██████████| 220/220 [05:23<00:00,  1.42s/it]100%|██████████| 220/220 [05:23<00:00,  1.47s/it]
{'loss': 0.3334, 'grad_norm': 0.2021484375, 'learning_rate': 4.795454545454546e-06, 'epoch': 0.23}
{'loss': 0.3709, 'grad_norm': 0.162109375, 'learning_rate': 4.568181818181819e-06, 'epoch': 0.45}
{'loss': 0.3445, 'grad_norm': 0.1806640625, 'learning_rate': 4.340909090909091e-06, 'epoch': 0.68}
{'loss': 0.3441, 'grad_norm': 0.19140625, 'learning_rate': 4.113636363636364e-06, 'epoch': 0.91}
{'loss': 0.3672, 'grad_norm': 0.1806640625, 'learning_rate': 3.886363636363637e-06, 'epoch': 1.14}
{'loss': 0.3274, 'grad_norm': 0.357421875, 'learning_rate': 3.6590909090909093e-06, 'epoch': 1.36}
{'loss': 0.3342, 'grad_norm': 0.1845703125, 'learning_rate': 3.4318181818181823e-06, 'epoch': 1.59}
{'loss': 0.3345, 'grad_norm': 0.220703125, 'learning_rate': 3.204545454545455e-06, 'epoch': 1.82}
{'loss': 0.3433, 'grad_norm': 0.18359375, 'learning_rate': 2.9772727272727274e-06, 'epoch': 2.05}
{'loss': 0.3436, 'grad_norm': 0.2099609375, 'learning_rate': 2.7500000000000004e-06, 'epoch': 2.27}
{'loss': 0.3481, 'grad_norm': 0.2294921875, 'learning_rate': 2.522727272727273e-06, 'epoch': 2.5}
{'loss': 0.3472, 'grad_norm': 0.189453125, 'learning_rate': 2.295454545454546e-06, 'epoch': 2.73}
{'loss': 0.3101, 'grad_norm': 0.25, 'learning_rate': 2.0681818181818184e-06, 'epoch': 2.95}
{'loss': 0.3649, 'grad_norm': 0.2216796875, 'learning_rate': 1.840909090909091e-06, 'epoch': 3.18}
{'loss': 0.3444, 'grad_norm': 0.212890625, 'learning_rate': 1.613636363636364e-06, 'epoch': 3.41}
{'loss': 0.3161, 'grad_norm': 0.1923828125, 'learning_rate': 1.3863636363636365e-06, 'epoch': 3.64}
{'loss': 0.3202, 'grad_norm': 0.1806640625, 'learning_rate': 1.159090909090909e-06, 'epoch': 3.86}
{'loss': 0.3588, 'grad_norm': 0.306640625, 'learning_rate': 9.31818181818182e-07, 'epoch': 4.09}
{'loss': 0.3257, 'grad_norm': 0.2451171875, 'learning_rate': 7.045454545454545e-07, 'epoch': 4.32}
{'loss': 0.3482, 'grad_norm': 0.177734375, 'learning_rate': 4.772727272727274e-07, 'epoch': 4.55}
{'loss': 0.3482, 'grad_norm': 0.2734375, 'learning_rate': 2.5000000000000004e-07, 'epoch': 4.77}
{'loss': 0.3156, 'grad_norm': 0.2080078125, 'learning_rate': 2.272727272727273e-08, 'epoch': 5.0}
{'train_runtime': 323.7783, 'train_samples_per_second': 2.718, 'train_steps_per_second': 0.679, 'train_loss': 0.34048644954508, 'epoch': 5.0}
Traceback (most recent call last):
  File "/srv/scratch/z5485311/GDL2NL/LLM/llama_finetune/finetune.py", line 97, in <module>
    df = pd.DataFrame(loss_logs)  # 通常包含: step, loss, learning_rate, epoch
NameError: name 'pd' is not defined. Did you mean: 'id'?

================================================================================
                     Resource Usage on 13/08/2025 17:56:51                      

Job Id: 6789399 
Queue: CSE
Walltime: 00:07:22  (requested 02:00:00)
Job unsucesfull. Exit Status 1 - Exit status refers to the exit value of the
top process in the job, typically the shell.
This may be the exit value of the last command executed in the shell.
See job output error.

--------------------------------------------------------------------------------
|              |             GPUs              |            Memory             |
--------------------------------------------------------------------------------
| Node  GPU ID | Requested   Used   Efficiency | Available   Used              |
| k099    2    |     1       0.69       69%    |143771 MiB  44.91G             |
--------------------------------------------------------------------------------
|Total         |     1       0.69      69.0%   |                               |
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
|              |             CPUs              |            Memory             |
--------------------------------------------------------------------------------
| Node         | Requested   Used   Efficiency | Requested   Used   Efficiency |
| k099         |     4       0.75      19.0%   |  48.0gb    16.3gb     34.0%   |
--------------------------------------------------------------------------------
